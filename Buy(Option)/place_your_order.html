<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Place Your Order</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">
  <div class="bg-white p-6 rounded-xl shadow-lg w-full max-w-md">
    <button onclick="placeOrder()" class="w-full bg-yellow-400 hover:bg-yellow-500 text-black font-bold py-2 px-4 rounded mb-4">Place your order</button>

    <hr class="my-4">

    <!-- Order Summary -->
    <div class="text-sm space-y-2 bg-gray-100 p-4 rounded shadow-inner">
      <div class="flex justify-between font-bold border-t pt-5">
        <span>AMOUNT :</span>
      </div>
      <div class="flex justify-between">
        <span>Items</span>
        <span id="itemAmount">₹0.00</span>
      </div>
      <div class="flex justify-between font-bold border-t pt-2">
        <span>Payable Amount:</span>
        <span id="totalAmount">₹0.00</span>
      </div>
    </div>

    <hr class="my-4">

    <!-- Payment Options -->
    <div class="border border-gray-300 rounded-md p-5">
      <h1 class="text-2xl font-bold mb-6 text-blue-600">Payment Option</h1>
      <div class="border border-gray-300 rounded-md p-4 mb-4">
        <label class="inline-flex items-center">
          <input type="radio" name="payment" value="upi" onclick="selectMethod('upi')" class="form-radio mr-2"> Pay with UPI
        </label>
      </div>
      <div class="border border-gray-300 rounded-md p-4">
        <p class="text-sm font-semibold mb-2">Other Methods</p>
        <div class="flex flex-col space-y-2">
          <div class="flex items-center">
            <label id="codLabel" class="inline-flex items-center">
              <input type="radio" id="codOption" name="payment" value="cod" onclick="selectMethod('cod')" class="form-radio mr-2"> Cash on Delivery (COD)
            </label>
            <span id="infoIcon" class="ml-2 cursor-pointer text-blue-500 hidden" onclick="toggleInfoBox(event)">ℹ️</span>
          </div>
          <div id="infoBox" class="text-xs bg-yellow-100 border border-yellow-400 text-yellow-700 p-2 rounded mt-1 hidden">
            COD Only available in 673645 and 673639
          </div>
          <label class="inline-flex items-center">
            <input type="radio" name="payment" value="netbanking" onclick="selectMethod('netbanking')" class="form-radio mr-2"> Net Banking
          </label>
        </div>
      </div>
    </div>

    <!-- Pincode Field (Hidden by Default) -->
    <div id="pincodeField" class="mt-4 hidden">
      <label for="codPincode" class="block text-sm font-medium mb-1">Enter Pincode:</label>
      <input type="text" id="codPincode" maxlength="6" class="w-full border border-gray-300 rounded px-3 py-2" placeholder="e.g. 673645" oninput="validatePincode(this.value)" />
    </div>

    <hr class="my-4">

    <!-- Address Section -->
    <form id="addressForm" class="space-y-4" onsubmit="saveAddress(event)">
      <div>
        <label for="fullname" class="block text-sm font-medium">Full Name</label>
        <input type="text" id="fullname" required class="w-full border border-gray-300 rounded px-3 py-2 mt-1">
      </div>
      <div>
        <label for="street" class="block text-sm font-medium">Street Address</label>
        <textarea id="street" required class="w-full border border-gray-300 rounded px-3 py-2 mt-1"></textarea>
      </div>
      <div>
        <label for="city" class="block text-sm font-medium">Town/City</label>
        <input type="text" id="city" required class="w-full border border-gray-300 rounded px-3 py-2 mt-1">
      </div>
      <div>
        <label for="state" class="block text-sm font-medium">State</label>
        <input type="text" id="state" required class="w-full border border-gray-300 rounded px-3 py-2 mt-1">
      </div>
      <div>
        <label for="district" class="block text-sm font-medium">District</label>
        <input type="text" id="district" required class="w-full border border-gray-300 rounded px-3 py-2 mt-1">
      </div>
      <div>
        <label for="pincode" class="block text-sm font-medium">Pincode</label>
        <input type="text" id="pincode" required class="w-full border border-gray-300 rounded px-3 py-2 mt-1">
      </div>
      <div>
        <label for="phone" class="block text-sm font-medium">Phone Number</label>
        <input type="text" id="phone" required class="w-full border border-gray-300 rounded px-3 py-2 mt-1">
      </div>
      <div>
        <label for="email" class="block text-sm font-medium">Email</label>
        <input type="email" id="email" required class="w-full border border-gray-300 rounded px-3 py-2 mt-1">
      </div>
      <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded">Save Address</button>
    </form>

    <!-- Address Review Panel -->
    <div id="addressReview" class="hidden mt-6 p-4 border border-gray-300 rounded-lg bg-gray-50">
      <h2 class="text-lg font-semibold mb-2">Saved Address</h2>
      <div id="reviewContent" class="text-sm text-gray-800"></div>
      <button onclick="editAddress()" class="mt-4 text-blue-600 hover:underline">Edit Address</button>
    </div>
  </div>

  <script>
    const codFee = 10;
    const productPrice = parseInt(sessionStorage.getItem("productPrice") || "499");
    document.getElementById("itemAmount").textContent = `₹${productPrice}`;
    document.getElementById("totalAmount").textContent = `₹${productPrice}`;

    function selectMethod(method) {
      const pincodeField = document.getElementById("pincodeField");
      const infoIcon = document.getElementById("infoIcon");
      const infoBox = document.getElementById("infoBox");
      if (method === 'cod') {
        pincodeField.classList.remove("hidden");
        infoIcon.classList.add("hidden");
        infoBox.classList.add("hidden");
      } else {
        pincodeField.classList.add("hidden");
        infoIcon.classList.add("hidden");
        infoBox.classList.add("hidden");
      }
    }

    function validatePincode(pincode) {
      const infoIcon = document.getElementById("infoIcon");
      const infoBox = document.getElementById("infoBox");
      const allowed = ["673645", "673639"];

      if (pincode.length === 6) {
        if (allowed.includes(pincode)) {
          infoIcon.classList.add("hidden");
          infoBox.classList.add("hidden");
        } else {
          infoIcon.classList.remove("hidden");
          infoBox.classList.add("hidden");
        }
      } else {
        infoIcon.classList.add("hidden");
        infoBox.classList.add("hidden");
      }
    }

    function toggleInfoBox(event) {
      event.preventDefault();
      const infoBox = document.getElementById("infoBox");
      infoBox.classList.toggle("hidden");
    }

    function saveAddress(e) {
      e.preventDefault();
      const data = {
        fullname: document.getElementById("fullname").value,
        street: document.getElementById("street").value,
        city: document.getElementById("city").value,
        state: document.getElementById("state").value,
        district: document.getElementById("district").value,
        pincode: document.getElementById("pincode").value,
        phone: document.getElementById("phone").value,
        email: document.getElementById("email").value
      };

      localStorage.setItem("shippingAddress", JSON.stringify(data));

      const content = document.getElementById("reviewContent");
      content.innerHTML = `
        <p><strong>${data.fullname}</strong></p>
        <p>${data.street}, ${data.city}</p>
        <p>${data.district}, ${data.state} - ${data.pincode}</p>
        <p>${data.phone} | ${data.email}</p>
      `;

      document.getElementById("addressForm").classList.add("hidden");
      document.getElementById("addressReview").classList.remove("hidden");
    }

    function editAddress() {
      const saved = JSON.parse(localStorage.getItem("shippingAddress"));
      if (saved) {
        document.getElementById("fullname").value = saved.fullname;
        document.getElementById("street").value = saved.street;
        document.getElementById("city").value = saved.city;
        document.getElementById("state").value = saved.state;
        document.getElementById("district").value = saved.district;
        document.getElementById("pincode").value = saved.pincode;
        document.getElementById("phone").value = saved.phone;
        document.getElementById("email").value = saved.email;

        document.getElementById("addressForm").classList.remove("hidden");
        document.getElementById("addressReview").classList.add("hidden");
      }
    }

    function placeOrder() {
      const selectedPayment = document.querySelector('input[name="payment"]:checked');
      if (!selectedPayment) {
        alert("Please select a payment method.");
        return;
      }
      
      // Save payment method
      sessionStorage.setItem("payment", selectedPayment.value);

      // Save address from localStorage to sessionStorage
      const address = JSON.parse(localStorage.getItem("shippingAddress"));
      if (address) {
      sessionStorage.setItem("fullname", address.fullname);
      sessionStorage.setItem("street", address.street);
      sessionStorage.setItem("city", address.city);
      sessionStorage.setItem("state", address.state);
      sessionStorage.setItem("district", address.district);
      sessionStorage.setItem("pincode", address.pincode);
      sessionStorage.setItem("phone", address.phone);
      sessionStorage.setItem("email", address.email);
    }
      const method = selectedPayment.value;
      if (method === "cod") {
        window.location.href = "order_confirmed_cod.html";
      } else if (method === "upi") {
        window.location.href = "upi_payment.html";
      } else {
        alert("Selected payment method not supported yet.");
      }
    }
  </script>
</body>
</html>













